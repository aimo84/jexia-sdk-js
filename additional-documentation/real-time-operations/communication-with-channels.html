<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Jexia Javascript SDK</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../../images/favicon.ico">
	      <link rel="stylesheet" href="../../styles/style.css">
        <link rel="stylesheet" href="../../styles/material.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../../" class="navbar-brand">Jexia Javascript SDK</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content additional-page">
                   <div class="content-data">














                   




<h2 id="communication-with-channels">Communication with channels</h2>
<p>Client-side applications can communicate with each other in real-time using channels which basically, allows sending and receiving messages through websocket. 
Before using this feature, you need to create at least one channel and an appropriate policy with allowed &quot;publish&quot; and &quot;subscribe&quot; actions. Channels can be managed with <a href="https://docs.jexia.com/getting-started/user-management/">Jexia Web Management Application</a>.  </p>
<p>When an application sends a message to the channel, everyone subscribed to that channel immediately receives it. If the persistent store is activated for the channel (using management application), it is also possible to get messaging history.</p>
<p>For more information about channels management, message size limitations and so, please read the official <a href="https://www.jexia.com/en/docs/jexia-pub-sub-service/">Jexia documentation page</a>.  </p>
<h3 id="initialize">Initialize</h3>
<p>To use real-time communication initialize Jexia client with the real-time module:  </p>
<div><pre class="line-numbers"><code class="language-javascript">import { jexiaClient, realTime } from &quot;jexia-sdk-js&quot;;  

const rtm = realTime();  

jexiaClient().init({  
  projectID: &quot;your-project-id&quot;,  
  key: &quot;your-api-key&quot;,    
  secret: &quot;your-api-secret&quot;  
}, rtm);  </code></pre></div><p>Then you can get your channel object (considered that channel has been already created in management application, otherwise an error will be thrown, see &quot;Handling errors&quot; below):</p>
<div><pre class="line-numbers"><code class="language-javascript">const channel = rtm.channel(&quot;my_channel&quot;);</code></pre></div><h3 id="subscribe-to-the-channel-events">Subscribe to the channel events</h3>
<p>Basically, channel object is inherited from the <a href="https://rxjs.dev/api/index/class/Observable">RxJS Observable</a>, so just use <code>subscribe()</code> method: </p>
<div><pre class="line-numbers"><code class="language-javascript">channel.subscribe(message =&gt; {
  // you received a message here!
});</code></pre></div><p>You can use <code>.pipe()</code> and any RxJS operators to have more flexibility:</p>
<div><pre class="line-numbers"><code class="language-javascript">channel.pipe(
  filter(message =&gt; message.from === user.id), // filter only specific user
  pluck(&quot;data&quot;) // pull out only data field 
).subscribe(data =&gt; {
  // you&#39;ve got data from the specific user here!
});</code></pre></div><h3 id="unsubscribe">Unsubscribe</h3>
<p> Don&#39;t forget to unsubscribe in case there is no needs to get messages from the channel anymore, just the use default RxJS <code>unsubscribe()</code> method:</p>
<div><pre class="line-numbers"><code class="language-javascript"> const subscription = channel.subscribe();
subscription.unsubscribe();</code></pre></div><h3 id="publish-to-the-channel">Publish to the channel</h3>
<p>You can publish any valid JSON type to the channel. Here is publishing a string example:</p>
<div><pre class="line-numbers"><code class="language-javascript">const message = &quot;Hey bro, did you feed our home rhino?&quot;;  
channel.publish(message); </code></pre></div><p>It is also can be an object:</p>
<div><pre class="line-numbers"><code class="language-javascript">channel.publish({
  product: &quot;apple&quot;,
  amount: 42
});  </code></pre></div><h3 id="get-the-message-history">Get the message history</h3>
<div><pre class="line-numbers"><code class="language-javascript">channel.getLog().subscribe(log =&gt; {
  // you will receive an array of all the messages here (see schema below)
});  </code></pre></div><p>It is also possible to use filters:</p>
<div><pre class="line-numbers"><code class="language-javascript">// load messages from the specific user
channel.getLog(field =&gt; field(&quot;sender_id&quot;).isEqualTo(user.id));</code></pre></div><h4 id="stored-message-schema">Stored message schema</h4>
<div><pre class="line-numbers"><code class="language-JSON">[{
  id: string, // uuid 
  sender_id: string, // uuid 
  sender_type: string, // either &quot;apk&quot; or &quot;ums&quot;,
  created_at: string, // Date in ISO format 
  updated_at: string, // Date in ISO format
  data: any,
}, {...}, ...]</code></pre></div><h3 id="errors-handling">Errors handling</h3>
<p>Some errors can happen during communications - channel might have not been created, a policy was incorrect or network troubles could occur. Any of those errors will be thrown from the observable and could be caught with the error handler.</p>
<p>In this example there is no such channel:</p>
<div><pre class="line-numbers"><code class="language-javascript">rtm.channel(&quot;my_camel&quot;).subscribe(
  message =&gt; {
    console.log(message); // we&#39;ve got a message from the channel
  },
  error =&gt; {
    console.log(error); // Subscription Error: (1001): resource &quot;my_camel&quot; is unavailable
  },
  () =&gt; { // complete
    // connection to the channel has been closed
  }
);</code></pre></div><p>You tries to get channel history, but policy does not allow you to read from the channel:</p>
<div><pre class="line-numbers"><code class="language-javascript">rtm.channel(&quot;not_my_channel&quot;).getLog().subscribe(
  messages =&gt; {
    console.log(messages); 
  },
  error =&gt; {
    console.log(error); // Subscription Error: (2): none of the given actions [&quot;read&quot;] for this resource are allowed
  }
);</code></pre></div>
                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 2;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'additional-page';
            var COMPODOC_CURRENT_PAGE_URL = 'communication-with-channels.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../../js/libs/custom-elements.min.js"></script>
       <script src="../../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../../js/menu-wc.js" defer></script>

       <script src="../../js/libs/bootstrap-native.js"></script>

       <script src="../../js/libs/es6-shim.min.js"></script>
       <script src="../../js/libs/EventDispatcher.js"></script>
       <script src="../../js/libs/promise.min.js"></script>
       <script src="../../js/libs/zepto.min.js"></script>

       <script src="../../js/compodoc.js"></script>

       <script src="../../js/tabs.js"></script>
       <script src="../../js/menu.js"></script>
       <script src="../../js/libs/clipboard.min.js"></script>
       <script src="../../js/libs/prism.js"></script>
       <script src="../../js/sourceCode.js"></script>
          <script src="../../js/search/search.js"></script>
          <script src="../../js/search/lunr.min.js"></script>
          <script src="../../js/search/search-lunr.js"></script>
          <script src="../../js/search/search_index.js"></script>
       <script src="../../js/lazy-load-graphs.js"></script>


    </body>
</html>
